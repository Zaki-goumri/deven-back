# AI Change Log - 2025-09-07

Author: AI Assistant

## Prompt
Apply improvements to `src/global/exception-filters/db.filter.ts` for safer typing, logging, and database error handling.

## Main Changes
- Added HTTP-only guard using `host.getType()`.
- Replaced `message: string | object` with `message: string | string[]` to match Nest `HttpException` shapes.
- Removed unsafe `any` casts and malformed ESLint disable comment; added safe narrowings for `HttpException` response.
- Supported TypeORM v0.3+ `driverError` structure for Postgres error codes and details.
- Hardened unique/not-null message extractors to read from `driverError`.
- Improved logging to guard against non-Error throws; structured messages and conditional stack usage.
- Added typed error response with optional `stack` in non-production.

## Files Modified
- `src/global/exception-filters/db.filter.ts`

## Notes
- No linter errors reported after changes.
- Consider adding RPC/WS filters if using Nest microservices transports.
